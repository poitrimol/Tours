{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Documentation de Tours","text":""},{"location":"#introduction","title":"Introduction","text":""},{"location":"#presentation-generale-de-lentreprise","title":"Pr\u00e9sentation g\u00e9n\u00e9rale de l\u2019entreprise","text":""},{"location":"#activite","title":"Activit\u00e9","text":"<p>SportLudique SARL est une soci\u00e9t\u00e9 implant\u00e9 en r\u00e9gion centre sp\u00e9cialis\u00e9e dans la conception et la fabrication d\u2019articles de sports et de loisirs compos\u00e9e de 452 personnes r\u00e9parties autour de trois sites g\u00e9ographiques : Chartres, Tours, Orl\u00e9ans.</p> <p>Elle dispose d\u2019un quatri\u00e8me site sur chateauroux suite \u00e0 la mise en place d\u2019une filiale sp\u00e9cialis\u00e9e dans la logistique.</p> <p>Le si\u00e8ge de SportLudique se situe dans l\u2019agglom\u00e9ration chartraine.</p> <p>Elle enregistre de bons r\u00e9sultats gr\u00e2ce \u00e0 une gamme de produits compl\u00e8te (pour tous les \u00e2ges) et conna\u00eet depuis peu un essor consid\u00e9rable proposant des installations cl\u00e9 en main aux collectivit\u00e9s</p>"},{"location":"#organigramme","title":"Organigramme","text":"<p>La Direction des Services Informatiques est sous la direction de Monsieur Claude Postic</p> <p>Celui-ci a sous ses ordres 4 techniciens.</p> <p>Le service RH est dirig\u00e9 par Ms Helen Paisley-Le Bihan.</p>"},{"location":"#situation-et-repartition-geographique","title":"Situation et r\u00e9partition g\u00e9ographique","text":"<p>La soci\u00e9t\u00e9 est articul\u00e9e autour de quatre sites g\u00e9ographiques :</p> <ul> <li> <p>le site de Chartres : il regroupe la direction, le marketing, les &gt; finances, les ressources humaines et la direction des services &gt; informatiques (DSI) ;</p> </li> <li> <p>le site d\u2019Orl\u00e9ans : il regroupe l\u2019usine de production des \u00e9quipements ext\u00e9rieurs bois.</p> </li> <li> <p>le site de Tours : il regroupe le laboratoire de test et la &gt; production des \u00e9quipements plastique</p> </li> <li> <p>le site de Chateauroux : situ\u00e9 id\u00e9alement au centre de la France, &gt; les stocks et la logistique sont la sp\u00e9cialit\u00e9 de ce site.</p> </li> </ul> <p></p>"},{"location":"#presentation-de-linfrastructure-informatique","title":"Pr\u00e9sentation de l\u2019infrastructure Informatique","text":""},{"location":"#vu-densemble-du-systeme-dinformation","title":"Vu d\u2019ensemble du Syst\u00e8me d\u2019Information","text":"<p>Le syst\u00e8me d'information (SI) de SportLudique refl\u00e8te la dynamique de l'entreprise : mis en place il y a quelques ann\u00e9es, il a depuis connu une expansion consid\u00e9rable. SportLudique est divis\u00e9e en quatre domaine windows autonomes, chacun op\u00e9rant sur un site g\u00e9ographique distinct et control\u00e9 par un controleur de domaine ind\u00e9pendant.</p> <p>En r\u00e9ponse \u00e0 la croissance de l'activit\u00e9 et \u00e0 divers projets informatiques, des serveurs Windows 2008 Server et Windows Server 2012 ont \u00e9t\u00e9 int\u00e9gr\u00e9s au syst\u00e8me. Cette initiative visait \u00e0 renforcer la fiabilit\u00e9 et \u00e0 ajouter des fonctionnalit\u00e9s, le tout sans perturber l'infrastructure existante.</p> <p>L'architecture actuelle repose sur la virtualisation, mise en \u0153uvre \u00e0 travers VMWare Esxi, bien que la version utilis\u00e9e soit la 5.0 en raison des licences disponibles.</p> <p>Chaque site b\u00e9n\u00e9ficie de son propre d\u00e9partement informatique, couvrant un large \u00e9ventail de responsabilit\u00e9s allant de l'administration \u00e0 l'assistance aux utilisateurs.</p> <p>Les utilisateurs font partie du domaine Active Directory, bien qu'ils puissent parfois utiliser des comptes d'administration locaux (comme le compte install/install) pour installer des logiciels r\u00e9pondant \u00e0 des besoins sp\u00e9cifiques. Ceci est en raison du fait que la gestion des configurations n'est pas centralis\u00e9e au sein de la Direction des Syst\u00e8mes d'Information (DSI) existante. Ils utilisent diverses applications adapt\u00e9es \u00e0 leurs activit\u00e9s, notamment des suites bureautiques telles que LibreOffice, ainsi que des outils graphiques ou des applications internes d\u00e9velopp\u00e9es au sein de l'entreprise.</p>"},{"location":"DNS/","title":"Configurer le DNS","text":""},{"location":"DNS/#installation-dns","title":"Installation DNS","text":"<p>Pr\u00e9requis : VM sous Windows Server 2022 via Nutanix.</p> <ul> <li>\u00c9tape 1 : Ouvrir le Gestionnaire de serveur.</li> </ul> <p>Une fois la VM configur\u00e9e et install\u00e9e, aller dans le Gestionnaire de serveur, aller sur G\u00e9rer tout en haut \u00e0 droite puis ajouter sur des r\u00f4les et fonctionnalit\u00e9s</p> <ul> <li>\u00c9tape 2 : Ajout du r\u00f4le DNS</li> </ul> <p>Une fois dans le Gestionnaire de serveur, cliquer sur \"G\u00e9rer\" dans le coin sup\u00e9rieur droit, puis s\u00e9lectionner \"Ajouter des r\u00f4les et des fonctionnalit\u00e9s\".</p> <p>Suivre l'Assistant d'installlation jusqu'\u00e0 \"R\u00f4les de serveurs\" et cocher \"Serveur DNS\" puis finir l'Assistant d'installation en suivant les \u00e9tapes.</p> <ul> <li>\u00c9tape 3 : Configuration de la nouvelle zone</li> </ul> <p>Ouvrir \"DNS\" depuis la barre de recherche Windows. Sous le noeud DNS, clic droit sur le nom WIN et cliquer sur \"Nouvelle zone\"</p> <ul> <li>\u00c9tape 4 : Cr\u00e9er une zone DNS principale</li> </ul> <p>Dans \"DNS\", d\u00e9velopper le n\u0153ud du serveur DNS (le nom de notre serveur) pour afficher la liste des zones DNS existantes.</p> <p>Cliquer avec le bouton droit sur \"Zones de recherche directe\" (Forward Lookup Zones) dans le volet gauche.</p> <p>S\u00e9lectionnez \"Nouvelle zone...\" pour ouvrir l'Assistant de cr\u00e9ation de zone.</p> <ul> <li>\u00c9tape 5 : Configuration de la zone DNS principale</li> </ul> <p>L'Assistant de cr\u00e9ation de zone s'ouvre. Cliquer sur \"Suivant\" pour commencer.</p> <p>Choisir le type de zone en s\u00e9lectionnant \"Zone Principale\" pour cr\u00e9er une zone DNS principale, puis cliquez sur \"Suivant\".</p> <p>Saisissez le nom de domaine pour la nouvelle zone DNS principale cr\u00e9\u00e9e. Par exemple, notre nom de zone est \"tours.sportludique.fr\", saisir \"tours.sportludique.fr\" et cliquez sur \"Suivant\".</p> <p>Enregistrer la zone dans un fichier sp\u00e9cifique (zone de stockage) ou de la laisser dans un fichier par d\u00e9faut. Pour la plupart des configurations standard, on laisse la configuration par d\u00e9faut. Cliquer sur \"Suivant\".</p> <p>On peut activer ou d\u00e9sactiver la mise \u00e0 niveau dynamique. Cocher \"Ne pas autoriser les mises \u00e0 jour dynamique\". Cliquez sur \"Suivant\".</p> <p>Cliquer sur \"Fermer\" pour valider la cr\u00e9ation.</p> <ul> <li>\u00c9tape 6 : Ajouter un h\u00f4te DNS \u00e0 la zone principale</li> </ul> <p>Ouvrir \"DNS\" comme d\u00e9crit pr\u00e9c\u00e9demment.</p> <p>Dans \"DNS\", d\u00e9velopper la zone principale que l'on a cr\u00e9\u00e9e sous le n\u0153ud \"Zones de recherche directe\" (Forward Lookup Zones).</p> <p>Cliquez avec le bouton droit sur la zone principale (de notre exemple, \"tours.sportludique.fr\") et s\u00e9lectionner \"Nouvel h\u00f4te (A ou AAAA)\" pour ajouter un nouvel h\u00f4te DNS.</p> <p>Remplir le nom, dans notre exemple c'est www et l'adresse ip publique de notre routeur, ici 183.44.37.1</p>"},{"location":"DNS/#configuration-dns-dans-lad","title":"Configuration DNS dans l'AD","text":"<p>Pour les utilisateurs interne du r\u00e9seau, le serveur dns sera notre Controleur de Domaine</p> <ul> <li>Etape 1 : Creer la Zone tours.sportludique.fr</li> </ul> <p>Dans \"DNS\", d\u00e9velopper le n\u0153ud du serveur DNS (le nom de notre serveur) pour afficher la liste des zones DNS existantes.</p> <p>Cliquer avec le bouton droit sur \"Zones de recherche directe\" (Forward Lookup Zones) dans le volet gauche.</p> <p>S\u00e9lectionnez \"Nouvelle zone...\" pour ouvrir l'Assistant de cr\u00e9ation de zone.</p> <ul> <li>Etape 2 : Configuration de la Zone tours.sportludique.fr</li> </ul> <p>L'Assistant de cr\u00e9ation de zone s'ouvre. Cliquer sur \"Suivant\" pour commencer.</p> <p>Choisir le type de zone en s\u00e9lectionnant \"Zone Principale\" pour cr\u00e9er une zone DNS principale, puis cliquez sur \"Suivant\".</p> <p>Saisissez le nom de domaine pour la nouvelle zone DNS principale cr\u00e9\u00e9e. Par exemple, notre nom de zone est \"tours.sportludique.fr\", saisir \"tours.sportludique.fr\" et cliquez sur \"Suivant\".</p> <p>Enregistrer la zone dans un fichier sp\u00e9cifique (zone de stockage) ou de la laisser dans un fichier par d\u00e9faut. Pour la plupart des configurations standard, on laisse la configuration par d\u00e9faut. Cliquer sur \"Suivant\".</p> <p>On peut activer ou d\u00e9sactiver la mise \u00e0 niveau dynamique. Cocher \"Ne pas autoriser les mises \u00e0 jour dynamique\". Cliquez sur \"Suivant\".</p> <p>Cliquer sur \"Fermer\" pour valider la cr\u00e9ation.</p> <ul> <li>Etape 3 : Ajout d'un H\u00f4te</li> </ul> <p>Ouvrir \"DNS\" comme d\u00e9crit pr\u00e9c\u00e9demment.</p> <p>Dans \"DNS\", d\u00e9velopper la zone principale que l'on a cr\u00e9\u00e9e sous le n\u0153ud \"Zones de recherche directe\" (Forward Lookup Zones).</p> <p>Cliquez avec le bouton droit sur la zone principale (de notre exemple, \"tours.sportludique.fr\") et s\u00e9lectionner \"Nouvel h\u00f4te (A ou AAAA)\" pour ajouter un nouvel h\u00f4te DNS.</p> <p>Remplir le nom, dans notre exemple c'est www et l'adresse ip de notre serveur http, ici 192.168.37.50</p>"},{"location":"OpenVPN/","title":"OpenVPN Server","text":""},{"location":"OpenVPN/#presentation","title":"Pr\u00e9sentation :","text":"<p>OpenVPN est une solution open-source de r\u00e9seau priv\u00e9 virtuel (VPN) qui permet de cr\u00e9er des connexions s\u00e9curis\u00e9es et crypt\u00e9es entre des ordinateurs distants via Internet. Il offre une solution flexible, extensible et compatible avec de nombreuses plateformes pour \u00e9tablir des tunnels VPN, permettant ainsi le transfert s\u00e9curis\u00e9 de donn\u00e9es sur des r\u00e9seaux non s\u00e9curis\u00e9s.</p>"},{"location":"OpenVPN/#mise-en-place-du-serveur-openvpn","title":"Mise en place du serveur OpenVPN :","text":"<ul> <li> <p>Etape 1 : Cr\u00e9ation d'une VM Debian 12</p> </li> <li> <p>Etape 2 : Installation de OpenVPN</p> <p>sudo apt-get update sudo apt install openvpn</p> </li> <li> <p>Etape 3 : Installation de Easy-RSA</p> </li> </ul> <p>Le package Easy-RSA fournit des utilitaires pour g\u00e9n\u00e9rer des paires de cl\u00e9s SSL utilis\u00e9es pour s\u00e9curiser les connexions VPN.</p> <pre><code>sudo apt install easy-rsa\n</code></pre> <ul> <li>Etape 4 : Initialiser PKI OpenVPN</li> </ul> <p>une cl\u00e9 publique et une cl\u00e9 priv\u00e9e pour le serveur et chaque client un certificat et une cl\u00e9 d'autorit\u00e9 de certification (CA) principale qui sont utilis\u00e9s pour signer chacun des certificats du serveur et du client.</p> <pre><code>cd /usr/share/easy-rsa/\n./easyrsa init-pki\n</code></pre> <ul> <li> <p>Etape 5 : G\u00e9nerer le Certificat et la cl\u00e9 de l'autorit\u00e9 de certification (CA)</p> <p>cd /usr/share/easy-rsa/ ./easyrsa build-ca</p> </li> </ul> <p>Cela vous demandera la cl\u00e9 CA, la phrase de passe PEM ainsi que le nom commun du serveur.</p> <p>Le certificat CA est g\u00e9n\u00e9r\u00e9 et stock\u00e9 dans  /usr/share/easy-rsa/pki/ca.crt</p> <ul> <li> <p>Etape 6 : G\u00e9n\u00e9rer des param\u00e8tres Diffie Hellman</p> <p>cd /usr/share/easy-rsa/ ./easyrsa gen-dh</p> </li> </ul> <p>Param\u00e8tres DH de taille 2048 cr\u00e9\u00e9s \u00e0 /usr/share/easy-rsa/pki/dh.pem</p> <ul> <li> <p>Etape 7 : G\u00e9n\u00e9rer le certificat et la cl\u00e9 du serveur OpenVPN</p> <p>cd /usr/share/easy-rsa/ ./easyrsa build-server-full serveur nopass</p> </li> </ul> <p>Saisissez la phrase secr\u00e8te de l'autorit\u00e9 de certification cr\u00e9\u00e9e ci-dessus pour g\u00e9n\u00e9rer les certificats et les cl\u00e9s.</p> <ul> <li> <p>Etape 8 : G\u00e9n\u00e9rer une cl\u00e9 de code d'authentification de message bas\u00e9e sur le hachage (HMAC)</p> <p>sudo openvpn --genkey secret /usr/share/easy-rsa/pki/ta.key</p> </li> <li> <p>Etape 9 : G\u00e9n\u00e9rer un certificat de r\u00e9vocation OpenVPN</p> <p>cd /usr/share/easy-rsa/ ./easyrsa gen-crl</p> </li> </ul> <p>Le certificat de r\u00e9vocation est g\u00e9n\u00e9r\u00e9 et stock\u00e9 dans  /usr/share/easy-rsa/pki/crl.pem</p> <ul> <li> <p>Etape 10 : Copier les certificats et les cl\u00e9s du serveur dans le r\u00e9pertoire de configuration du serveur</p> <p>cp -rp /usr/share/easy-rsa/pki/{ca.crt,dh.pem,ta.key,crl.pem,issued,private} /etc/openvpn/server/</p> </li> <li> <p>Etape 11 : G\u00e9n\u00e9rer des certificats et des cl\u00e9s client OpenVPN</p> <p>cd /usr/share/easy-rsa/ ./easyrsa build-client-full  nopass <li> <p>Etape 12 : Copier les certificats clients et les cl\u00e9s dans le r\u00e9pertoire client</p> <p>mkdir /etc/openvpn/client/ cp -rp /usr/share/easy-rsa/pki/{ca.crt,issued/.crt,private/.key} /etc/openvpn/client/ <li> <p>Etape 13 : Configurer le serveur OpenVPN sur Debian 12</p> </li> <p>Copiez l'exemple de configuration du serveur OpenVPN dans /etc/openvpn/server</p> <pre><code>cp /usr/share/doc/openvpn/examples/sample-config-files/server.conf /etc/openvpn/server/\n</code></pre> <p>Commande pour voir les modifications effectuer :      grep -vE \"^$|^#|^;\" /etc/openvpn/server/server.conf</p> <pre><code>port 1194\nproto udp4\ndev tun\nca ca.crt\ncert issued/server.crt\nkey private/server.key  # This file should be kept secret\ndh dh.pem \ntopology subnet\nserver 172.16.20.0 255.255.255.0\nifconfig-pool-persist /var/log/openvpn/ipp.txt\npush \"redirect-gateway def1 bypass-dhcp\"\npush \"dhcp-option DNS 9.9.9.9\"\npush \"dhcp-option DNS 8.8.8.8\"\nclient-to-client\nkeepalive 10 120\ntls-auth ta.key 0 # This file is secret\ncipher AES-256-CBC\npersist-key\npersist-tun\nstatus /var/log/openvpn/openvpn-status.log\nlog-append  /var/log/openvpn/openvpn.log\nverb 3\nexplicit-exit-notify 1\nauth SHA512\n</code></pre> <ul> <li>Etape 14 : Configurer le transfert IP</li> </ul> <p>D\u00e9commentez la ligne , net.ipv4.ip_forward=1pour /etc/sysctl.confactiver le transfert de paquets pour IPv4</p> <pre><code>sed -i 's/#net.ipv4.ip_forward=1/net.ipv4.ip_forward=1/' /etc/sysctl.conf\n</code></pre> <p>Appliquez les modifications sans red\u00e9marrer le serveur.</p> <pre><code>sysctl -p\n</code></pre> <ul> <li> <p>Etape 15 : Autoriser le port du service OpenVPN via le pare-feu</p> <p>ufw autorise 1194/udp</p> </li> <li> <p>Etape 16 : Configurer le Masquerading sur le pare-feu</p> </li> </ul> <p>Trouvez votre interface par d\u00e9faut via laquelle vos paquets sont envoy\u00e9s.</p> <pre><code>ip route get 10.28.37.1\n</code></pre> <p>Ensuite on met a jour les r\u00e8gles du pare-feu</p> <pre><code>vim /etc/ufw/before.rules\n</code></pre> <p>Ajoutez les lignes suivantes juste avant les *filterparam\u00e8tres du tableau. Notez que l'interface utilis\u00e9e doit correspondre au nom de l'interface ci-dessus</p> <pre><code>*nat\n:POSTROUTING ACCEPT [0:0]\n-A POSTROUTING -s 10.28.37.0/24 -o enp0s3 -j MASQUERADE\nCOMMIT\n# Don't delete these required lines, otherwise there will be errors\n*filter\n</code></pre> <p>Activer le transfert de paquets UFW </p> <pre><code>sed -i 's/DEFAULT_FORWARD_POLICY=\"DROP\"/DEFAULT_FORWARD_POLICY=\"ACCEPT\"/' /etc/default/ufw\n</code></pre> <p>Recharger le pare-feu</p> <pre><code>ufw reload\n</code></pre> <ul> <li> <p>Etape 17 : Ex\u00e9cuter le serveur OpenVPN</p> <p>systemctl enable --now openvpn-server@server</p> </li> </ul> <p>V\u00e9rifier le status</p> <pre><code>systemctl status openvpn-server@server\n</code></pre>"},{"location":"Reverse-Proxy/","title":"-Reverse Proxy","text":""},{"location":"Reverse-Proxy/#installation","title":"Installation","text":"<ul> <li> <p>Etape 1 : Cr\u00e9ation d'une VM Debian 12</p> </li> <li> <p>Etape 2 : Installation de nginx</p> </li> </ul> <p>sudo apt-get update sudo apt-get install nginx</p>"},{"location":"Reverse-Proxy/#configurer-nginx","title":"Configurer nginx","text":"<ul> <li>Etape 1 : Acceder au fichier de conf de nginx</li> </ul> <p>sudo nano /etc/nginx/nginx.conf</p> <ul> <li> <p>Etape 2 : Ajouter dans http { et modifier selon notre infrastructure :  server {         listen 80;         server_name www.tours.sportludique.fr ; </p> <pre><code>location / {\n    proxy_pass http://192.168.37.50:80;   //avec une resolution donnant l'IP interne par le resolver\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto $scheme;\n}\n</code></pre> <p>}</p> <p>server {     listen 80;     server_name blog.tours.sportludique.fr;</p> <pre><code>location / {\n    proxy_pass http://192.168.37.50:80; // avec un port d'\u00e9coute sp\u00e9cifique \u00e0 un vhost\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto $scheme;\n}\n</code></pre> <p>}</p> <p>server {     listen 80;     server_name node.tours.sportludique.fr;</p> <pre><code>location / {\n    proxy_pass http://192.168.37.10:8080;  #\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto $scheme;\n}\n</code></pre> <p>} }</p> </li> <li> <p>Etape 4 : Sauvegarder, fermer le fichier, tester et red\u00e9marrer nginx</p> </li> </ul> <p>sudo nginx -t //Permet de tester la configuration nginx</p> <p>sudo systemctl restart nginx //Permet de red\u00e9marrer ngninx</p> <ul> <li>Etape 5 : Activer le support HTTPS</li> </ul> <p>server {         listen 80;         server_name www.tours.sportludique.fr ; </p> <pre><code>    location / {\n        proxy_pass http://192.168.37.50:80;   //avec une resolution donnant l'IP interne par le resolver\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n\n//Activer le support HTTPS\n\nserver {\n    listen 443 ssl;\n    server_name www.tours.sportludique.fr;\n\n    ssl_certificate /etc/nginx/certificats/server.pem;\n    ssl_certificate_key /etc/nginx/certificats/key.pem;\n\n    location / {\n        proxy_pass http://\n        include etc/nginx/proxy_params;\n    }\n}\n\nserver {\n    listen 80;\n    server_name blog.tours.sportludique.fr;\n\n    location / {\n        proxy_pass http://192.168.37.50:80; // avec un port d'\u00e9coute sp\u00e9cifique \u00e0 un vhost\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n\nserver {\n    listen 80;\n    server_name node.tours.sportludique.fr;\n\n    location / {\n        proxy_pass http://192.168.37.10:8080;  #\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n\nserver {\n    listen 443 ssl;\n    server_name node.tours.sportludique.fr;\n    ssl_certificate /etc/nginx/certificats/server.pem;\n    ssl_certificate_key /etc/nginx/certificats/key.pem;\n\n    location / {\n        proxy_pass http://192.168.37.10:8080;\n        include /etc/nginx/proxy_params;\n    }\n}\n</code></pre> <p>}</p> <ul> <li>Etape 6 : Mettre les enregistrements dans le serveur DNS</li> </ul> <p>www    CNAME   ReverseProxy.tours.sportludique.fr blog   CNAME   ReverseProxy.tours.sportludique.fr node   CNAME   ReverseProxy.tours.sportludique.fr</p> <p>ReverseProxy   A   192.168.37.20</p>"},{"location":"Server_hmail/","title":"Hmail Server","text":""},{"location":"Server_hmail/#installation","title":"Installation","text":"<ul> <li>Etape 1 : Installation de Hmail Server</li> </ul> <p>On installe la version 2.0 de Dotnet Framework</p> <p>On installe la derniere version de HmailServer</p> <p>On coche une base de donn\u00e9e interne dans l'installations</p> <ul> <li>Etape 2 : Configuration du server Hmail</li> </ul> <p>Dans l'onglet Domain:</p> <p>on ajoute notre domaine </p> <pre><code>tours.sportludique.fr\n</code></pre> <p>on ajoute un compte dans le domaine</p> <p>Dans l'onglet Setting/Protocol/SMTP/Delivery of e-mail/Local Host Name</p> <pre><code>mail.tours.sportludique.fr\n</code></pre> <p>on laisse vide le Remote Host Name</p> <p>Dans l'onglet Setting/Protocol/SMTP/Delivery of e-mail/Advanced</p> <p>on laisse vide Bind to local IP address</p> <p>on decoche StartTLS</p> <p>On d\u00e9sactive Auto-BAN</p> <ul> <li>Etape 3 : Configuration des enregistrement DNS</li> </ul> <p>DNS Server Interne : </p> <p>On ajoute un nouvelle H\u00f4te :      H\u00f4te = mail     Ip address = SRV Hmail address</p> <p>On ajoute un nouvelle enregistrement MX :      nom de domaine pleinement qualifier : mail.tours.sportludique.fr</p> <p>DNS Server Externe :</p> <p>Nouvelle enregistrement MX :     nom de domaine pleinement qualifier : pointe vers l'adresse ip publique du routeur</p> <ul> <li>Etape 4 : Configuration du client</li> </ul> <p>On installe ThunderBird comme client de messagerie et on configure notre adresse mail.</p>"},{"location":"activation_SSH/","title":"Configurer le Switch","text":""},{"location":"activation_SSH/#activer-le-ssh","title":"Activer le ssh","text":""},{"location":"activation_SSH/#etape-1-reinitialiser-le-switch","title":"Etape 1 : R\u00e9initialiser le switch","text":"<p>Pour r\u00e9initialiser il nous suffit de rester appui\u00e9 sur le bouton de r\u00e9initialisation du switch pendant 10sec</p>"},{"location":"activation_SSH/#etape-2-configuration","title":"Etape 2 : Configuration","text":""},{"location":"activation_SSH/#etape-3-configuration-de-base","title":"Etape 3 : Configuration de Base :","text":"<p>Pour commencer nous allons changer le nom du switch :</p> <pre><code>#hostname \"sw-tours\"\n</code></pre> <p>Puis nous ajoutons un nom de domaine : </p> <pre><code>#ip domain-name \"tours.sportludique.local\"\n</code></pre> <p>Cr\u00e9ation d'un vlan de Management :</p> <pre><code>#vlan \"220\"\n#name \"Management\"\n#\"exit\"\n#int vlan 220\n#ip address 172.28.32.254 255.255.255.0\n</code></pre> Nom du Vlan Vlan Management 220 DMZ PUB 221 Serveur 222 DMZ PRV 223 Conception 226 Production 227 Transport-firewall 228 Transport-routeur 229"},{"location":"activation_SSH/#activer-le-ssh-sur-un-switch-cisco","title":"Activer le SSH sur un Switch Cisco","text":""},{"location":"activation_SSH/#etape-1-verifier-la-version-de-lequipement-cisco-pour-le-protocole-ssh","title":"Etape 1 : V\u00e9rifier la version de l'\u00e9quipement Cisco pour le protocole SSH","text":"<p>On v\u00e9rifie la version du switch a l'aide de la commande #\"show version\" pour s'assur\u00e9 que le switch soit compatible avec le protocole SSH.</p>"},{"location":"activation_SSH/#etape-2-creation-du-nom-dhote-et-du-nom-de-domaine-et-dun-mot-de-passe-pour-le-mode-privilegie","title":"Etape 2 : Cr\u00e9ation du nom d'h\u00f4te et du nom de domaine, et d'un mot de passe pour le mode privil\u00e9gi\u00e9","text":"<p>La cr\u00e9ation d\u2019un nom d\u2019h\u00f4te et d\u2019un nom de domaine est indispensable \u00e0 la configuration d\u2019une connexion SSH. Vous devez donc \u00eatre en mode configuration et r\u00e9aliser les commandes suivantes :</p> <p> <p>Ici, nous avons choisi de donner pour nom d\u2019h\u00f4te \"admin\" et pour nom de domaine tours.sportludique.fr.</p> <p>Pour cr\u00e9er un mot de passe pour le mode privil\u00e9gi\u00e9, il faut se placer dans le mode configuration et entrer la commande :</p> <pre><code>#enable password \"P@ssw0rd123456!\"\n</code></pre>"},{"location":"activation_SSH/#etape-3-generation-de-la-paire-de-cles-asymetriques-rsa","title":"Etape 3 : G\u00e9n\u00e9ration de la paire de cl\u00e9s asym\u00e9triques RSA","text":"<p>la cl\u00e9 RSA est une m\u00e9thode de chiffrement dite asym\u00e9trique. Elle est compos\u00e9e de deux cl\u00e9s, une priv\u00e9e et une publique, chiffr\u00e9es sur 768 bits minimum pour le SSH v2, et permet d\u2019assurer une s\u00e9curit\u00e9 optimale. Pour g\u00e9n\u00e9rer cette paire de cl\u00e9s, il suffit d\u2019entrer dans la conf puis entrer la commande :</p> <pre><code>#crypto key generate rsa\n</code></pre> <p>Il est \u00e9galement demand\u00e9 d\u2019entrer la taille souhait\u00e9e de la cl\u00e9 en bits. Il est pr\u00e9f\u00e9rable de choisir une taille sup\u00e9rieure \u00e0 768 bits pour assurer une plus grande s\u00e9curit\u00e9. Nous avons ici choisi des cl\u00e9s de 1024 bits.</p>"},{"location":"activation_SSH/#etape-4-activation-du-protocole-ssh-sur-le-switch-ou-routeur-cisco","title":"Etape 4 : Activation du protocole SSH sur le switch ou routeur Cisco","text":"<p>Pour activer le protocole SSH, il suffit d\u2019entrer la commande #\u201cip ssh version 2\u201d. Il faut ensuite entrer en mode configuration de ligne VTY dans le but de :</p> <ul> <li>n\u2019accepter que les connexions SSH au switch, au moyen de la commande \u201ctransport input ssh\u201d ;</li> <li>ne permettre que des connexions SSH vers d\u2019autres \u00e9quipements, au moyen de la commande \u201ctransport output ssh\u201d ;</li> <li>enregistrer le compte utilisateur existant comme compte permettant de mettre en place la connexion en entrant \u201clogin local\u201d.</li> </ul> <p>Commande</p> <pre><code>#ip ssh version 2\n#line vty 0 4\n#transport input ssh\n#transport output ssh\n#login local\n#exit\n</code></pre> <p>Si vous n\u2019avez pas encore cr\u00e9\u00e9 de compte utilisateur, retournez en mode configuration et entrez la commande suivante :</p> <pre><code>#username \"nom_utilisateur\" password \"mot_de_passe\"\n</code></pre> <p>Pour v\u00e9rifier que la configuration a bien \u00e9t\u00e9 prise en compte par l\u2019\u00e9quipement, entrez \u201cshow run\u201d.</p>"},{"location":"activation_SSH/#etape-5-test-de-connexion-ssh-avec-putty","title":"Etape 5 : Test de connexion SSH avec PuTTy","text":"<p>Pour le mettre en mode SSH, il vous suffit de cliquer sur \u201cSSH\u201d et d\u2019entrer le nom d\u2019h\u00f4te ou l\u2019adresse IP de l\u2019\u00e9quipement auquel vous voulez vous connecter.</p> <p>Pour le mettre en mode SSH, il vous suffit de cliquer sur \u201cSSH\u201d et d\u2019entrer le nom d\u2019h\u00f4te ou l\u2019adresse IP de l\u2019\u00e9quipement auquel vous voulez vous connecter.</p>"},{"location":"activation_SSH/#etape-6-route-par-defaut","title":"Etape 6 : Route par Defaut","text":"<p>Ajouter la Route par Defaut sur le switch. La route par defaut va etre l'adresse IP qui va nous permettre de sortir vers le Firewall.</p>"},{"location":"activation_SSH/#attribution-dun-port-a-un-vlan","title":"Attribution d'un port a un vlan :","text":"<p>On entre dans la configuration du switch puis on entre sur l'interface : </p> <pre><code>#int gi0/1\n#switchport mode access\n#switchport access vlan 220\n#exit\n\n\n#show vlan\n</code></pre> Vlan Port attribuer 220 gi0/1 - gi0/2 222 gi0/3 226 gi0/13 227 gi0/14 228 gi0/18 - gi0/20 229 gi0/17 - gi0/19 - gi0/21"},{"location":"activation_SSH/#relais-dhcp","title":"Relais DHCP","text":"<p>On active le relais DHCP pour relayer la communication DHCP entre les h\u00f4tes et le serveur DHCP sur les Vlans :</p> <pre><code>#int vlan 222\n#ip helper-address 172.28.37.1\n\n#show run\n</code></pre>"},{"location":"certificat%20ssl/","title":"Certificat SSL","text":"<ul> <li>Etape 1 : Autorit\u00e9 de Certification</li> </ul> <p>On g\u00e9n\u00e9r\u00e9 une cl\u00e9 priv\u00e9e pour la nouvelle CA (Autorit\u00e9 de Certification)</p> <pre><code>openssl genrsa -out nouvelle_ca.key 4096\n</code></pre> <p>Ensuite, on cr\u00e9\u00e9 un certificat auto-sign\u00e9 pour cette CA</p> <pre><code>openssl req -x509 -new -nodes -key nouvelle_ca.key -sha256 -days 365 -out nouvelle_ca.crt\n</code></pre> <p>On rempli les informations demand\u00e9es pour le certificat.</p> <ul> <li>Etape 2 : Cl\u00e9 priv\u00e9e de la certification du serveur</li> </ul> <p>On g\u00e9n\u00e9re la cl\u00e9 priv\u00e9e pour le certificat du serveur</p> <pre><code>openssl genrsa -out server.key 2048\n</code></pre> <p>On Cr\u00e9er une demande de signature de certificat (CSR) pour le serveur On a g\u00e9n\u00e9r\u00e9 un CSR pour le serveur avec la cl\u00e9 priv\u00e9e cr\u00e9\u00e9e pr\u00e9c\u00e9demment</p> <pre><code>openssl req -new -key server.key -out server.csr\n</code></pre> <p>On a fourni les informations n\u00e9cessaires pour le certificat.</p> <p>-Etape 3 Signature du certificat :</p> <p>Signature du certificat du serveur avec la nouvelle CA On a sign\u00e9 le CSR du serveur avec la nouvelle CA pour \u00e9mettre un certificat</p> <pre><code>openssl x509 -req -in server.csr -CA nouvelle_ca.crt -CAkey nouvelle_ca.key -CAcreateserial -out server.crt -days 365 -sha256\n</code></pre>"},{"location":"firewall/","title":"Configuration du Firewall","text":""},{"location":"firewall/#installation","title":"Installation","text":"<ul> <li>Etape 1 : Se connecter au Firewall</li> </ul> <p>Nous le connectons sur le PC pour la premiere utilisation.</p> <p>Nous accedons au firewall pour la premiere fois via un l'IP 10.0.0.254/8. Nous devons donc changer l'ip du poste dans l'adresse ip du Firewall, puis nous avons juste a ouvrir un navigateur tel que Google et se connecter au firewall via l'URL \"\"https://10.0.0.254/admin\"\"</p> <ul> <li>Etape 2 : Activation de License </li> </ul> <p>Pour activer la License il nous suffit de ce rendre dans \"SYSTEM -&gt; LICENSE\", puis on ajoute la Licence (au pr\u00e9alable r\u00e9cuperer au pr\u00e8s de Mr Mery).</p> <ul> <li>Etape 3 : Formatage de la carte SD</li> </ul> <p>Pour Formater la carte SD nous nous rendons dans \"NOTIFICATION -&gt; Logs\" puis on choisi notre carte SD, puis on Format.</p> <ul> <li>Etape 4 : Parametres du Firewall</li> </ul> <p>On d\u00e9cide de changer le mot de passe Admin. Pour ce faire nous nous rendons</p> <ul> <li>Etape 5 : Param\u00e9trages Interfaces</li> </ul> <p>Pour parametres les interfaces on se rend dans \"NETWORK -&gt; Interfaces\" puis nous configurons nos interfaces In et Out.</p> <p>On mes des ip static sur chaque interfaces puis nous ajoutons la passerelle par default qui nous serviras a sortir (passerelle routeur).</p> <ul> <li>Etape 6 : Passerelle par defaut</li> </ul> <p>On ajoute la \"Default Gateway\" dans l'onglet \"Network -&gt; Routing\".</p> <p>On cr\u00e9e un nouvel objet en tant que Routeur en ajoutant notre passerelle pour sortir du Parefeu vers les Routeurs.</p> <p>On peut tester un ping vers Google \"8.8.8.8\" sur le pc et le Firewall en faisant la commande :  </p> <pre><code>SYSTEM PING host=\"adresse ip de l'hote\".\n</code></pre> <ul> <li>Etape 7 : R\u00e8gles de Filtrages et de NAT</li> </ul> <p>Pour le moment nous choissirons le type de filtrage en \"Pass All\" pour pouvoir faire nos test.</p> <p>On ajoute une r\u00e9gle de NAT Dynamique qui va nous permettre de Nat\u00e9 une premi\u00e8re fois via le Firewall avant les routeurs.</p> <p> </p> <ul> <li>Etape 8 : Route Statique</li> </ul> <p>On ajoute les routes des sous r\u00e9seaux de Production et de Conception, en d\u00e9finissant bien les r\u00e9seaux en \"Network\" et non en \"Hote\" et la \"Gateway\" en \"Routeur\" et non un \"Hote\".</p>"},{"location":"firewall/#dmz-prive","title":"DMZ Priv\u00e9","text":"<ul> <li> <p>\u00c9tape 1 : Connexion \u00e0 l'interface graphique : Connectez-vous \u00e0 l'interface graphique de votre Stormshield Network Security en utilisant un navigateur Web et en entrant l'adresse IP du dispositif dans la barre d'adresse. (https://172.28.40.254/admin/admin.html)</p> </li> <li> <p>\u00c9tape 2 : Ajouter les VLAN : Trouvez l'option pour ajouter de nouveaux VLAN, cela implique de sp\u00e9cifier le nom du VLAN \"dmz1-pub\" et \"dmz2-prv\", l'ID VLAN correspond au num\u00e9ro vlan attribuer (221 pour la dmz publique, 223 pour la dmz priv\u00e9), et l'adresse IP et le masque de sous-r\u00e9seau associ\u00e9s. (pub = 192.168.37.254 /24, prv = 192.168.137.254 /24)</p> </li> </ul> <p></p> <ul> <li> <p>\u00c9tape 3 : Configurer l'interface DMZ : Acc\u00e9dez \u00e0 la configuration de l'interface DMZ. Assurez-vous que l'interface DMZ est configur\u00e9e avec l'adresse IP \"172.16.0.1\" et le masque de sous-r\u00e9seau \"/16\".</p> </li> <li> <p>\u00c9tape 4 : Configurer les ports pour les VLAN : Associez les ports physiques de votre switch \u00e0 chaque VLAN. Assurez-vous que le port DMZ est configur\u00e9 en mode \"off\" pour qu'il ne soit pas inclus dans les VLAN, mais conserve sa configuration d'adresse IP.</p> </li> </ul>"},{"location":"heartbeat/","title":"Configuration de Heart Beat","text":""},{"location":"heartbeat/#presentation","title":"Pr\u00e9sentation","text":"<p>Heartbeat est un logiciel de haute disponibilit\u00e9 open source largement utilis\u00e9 dans les environnements de serveurs pour garantir la continuit\u00e9 des services en cas de d\u00e9faillance mat\u00e9rielle ou logicielle. Il est particuli\u00e8rement adapt\u00e9 pour les clusters de serveurs, o\u00f9 plusieurs n\u0153uds coop\u00e8rent pour assurer une disponibilit\u00e9 constante des services.</p>"},{"location":"heartbeat/#installation","title":"Installation","text":"<ul> <li>Etape 1 : Cloner la VM \"TRS_ReverseProxy\" </li> </ul> <p>Tout d'abord il faut cloner la VM avec le Reverse Proxy d\u00e9j\u00e0 configur\u00e9, puis changer le nom des VM pour les identifi\u00e9s (TRS-ReverseProxy-1 et -2) et enfin changer l'adresse IP du clone (192.168.37.21)</p> <ul> <li>Etape 2 : Installation de HeartBeat</li> </ul> <pre><code># Mettez \u00e0 jour votre liste de paquets\nsudo apt-get update\n\n# Installez Heartbeat\nsudo apt-get install heartbeat\n</code></pre> <ul> <li>\u00c9tape 2 : Configuration de Heartbeat sur les 2 serveurs Proxy</li> </ul> <p>Cr\u00e9er l'un des fichiers de conf :</p> <pre><code>sudo nano /etc/ha.d/ha.cf\n</code></pre> <p>Assurez-vous que votre fichier ha.cf ressemble \u00e0 quelque chose comme ceci :</p> <pre><code>node Trs-ReverseProxy-1\nucast ens3 192.168.37.20\nnode Trs-ReverseProxy-2\nucast ens3 192.168.37.21\n</code></pre> <ul> <li>\u00c9tape 3 : Configuration des Ressources Heartbeat</li> </ul> <p>Les ressources que Heartbeat doit surveiller et g\u00e9rer sont sp\u00e9cifi\u00e9es dans le fichier haresources (que vous devez cr\u00e9er). \u00c9ditez ce fichier, ajoutez les lignes n\u00e9cessaires pour sp\u00e9cifier les ressources que Heartbeat doit g\u00e9rer :</p> <pre><code>Trs-ReverseProxy-1 IPaddr::192.168.37.22/24/ens3/0\n</code></pre> <pre><code>Trs-ReverseProxy-1 IPaddr::192.168.37.22/24/ens3/1\n</code></pre> <p>Ici le 0 et le 1 qui diff\u00e8re indique la priorit\u00e9 (0 est la plus haute). Cela indique \u00e0 Heartbeat de surveiller l'adresse IP 192.168.37.22 (qu'est la VIP) et de la migrer vers Trs-ReverseProxy-1 en cas de d\u00e9faillance.</p> <ul> <li>\u00c9tape 4: Cr\u00e9er la cl\u00e9 d'authentification \"Authkeys\"</li> </ul> <p>Cr\u00e9er un fichier /etc/ha.d/authkeys avec des droits sp\u00e9cifiques.</p> <pre><code>sudo nano /etc/ha.d/authkeys\n</code></pre> <p>G\u00e9n\u00e9rer une cl\u00e9 priv\u00e9e dans ce fichier. Assurez-vous que le fichier est accessible uniquement par l'utilisateur root pour des raisons de s\u00e9curit\u00e9 :</p> <pre><code>sudo chmod 600 /etc/ha.d/authkeys\n</code></pre> <ul> <li>\u00c9tape 5: Red\u00e9marrez Heartbeat</li> </ul> <pre><code>sudo systemctl restart heartbeat\n</code></pre> <ul> <li>\u00c9tape 6: V\u00e9rifier sur les deux proxy </li> </ul> <pre><code>ping 192.168.37.22\n</code></pre>"},{"location":"hmailserver/","title":"Hmailserver","text":""},{"location":"hmailserver/#installation-de-hmailserver","title":"Installation de hmailserver","text":"<ul> <li>Etape 1</li> </ul> <p>Installer une machine virtuelle Windows 10 ou Windows Server.</p> <ul> <li>Etape 2</li> </ul> <p>Installer la derni\u00e8re version de hmailserver sur le site officiel.</p>"},{"location":"hmailserver/#configuration-de-hmailserver-en-local","title":"Configuration de hmailserver en local","text":"<ul> <li>Etape 1 : Ajouter le nom de domaine</li> </ul> <p>Aller dans Domains puis Add... et mettre notre nom de domaine : tours.sportludique.fr</p> <ul> <li>Etape 2 : Ajouter les utilisateurs</li> </ul> <p>Aller dans Accounts puis Add... et mettre nos noms d'utilisateurs, par exemple : </p> <p>Dans Address : prenom.nom@tours.sportludique.fr Mettre Administration Level en User</p> <ul> <li>Etape 3 : Configurer le protocole</li> </ul> <p>Aller dans Protocols et v\u00e9rifier que SMTP, POP3 et IMAP sont coch\u00e9s puis aller dans SMTP en bas de Protocols.</p> <p>Aller dans l'onglet Delivery of e-mail, mettre localhost dans localhostname et dans remotehostname : mail.tours.sportludique.fr en port 25.</p> <p>Aller dans l'onglet advanced et mettre l'adresse ip local, ici : 127.0.0.1</p> <p>Ne pas oublier de mettre l'enregistrement MX dans les deux serveurs DNS</p>"},{"location":"hsrp/","title":"HSRP &amp; GLPB","text":""},{"location":"hsrp/#presentation","title":"Pr\u00e9sentation","text":"<p>Le protocole HSRP (Hot Standby Router Protocol) est un protocole de routage de premier hop redondant (FHRP) con\u00e7u pour am\u00e9liorer la disponibilit\u00e9 et la redondance dans les r\u00e9seaux locaux (LAN). Son objectif principal est de garantir la disponibilit\u00e9 et la tol\u00e9rance aux pannes dans les environnements r\u00e9seau en permettant \u00e0 plusieurs routeurs de travailler ensemble pour cr\u00e9er une passerelle virtuelle commune. Elle assure une haute disponibilit\u00e9 pour le trafic entrant destin\u00e9 \u00e0 l'adresse IP virtuelle, en permettant au routeur standby (passif) de prendre automatiquement le relais si le routeur actif \u00e9choue. Cela garantit une continuit\u00e9 de service pour les dispositifs connect\u00e9s au r\u00e9seau \u00e0 travers cette interface.</p>"},{"location":"hsrp/#mise-en-place-du-protocole-hsrp","title":"Mise en place du protocole HSRP","text":"<p>Une fois que tous les routeurs sont op\u00e9rationnels (qu\u2019ils font bien tous office de passerelle individuellement), nous pouvons passer \u00e0 la mise en place du HSRP. Sur chaque routeur, il faut maintenant d\u00e9finir une IP (en plus des IP d\u2019interfaces d\u00e9j\u00e0 d\u00e9finies) qui sera l\u2019IP du routeur virtuel et une priorit\u00e9 si l\u2019on souhaite changer celle par d\u00e9faut :</p> <p>Routeur 1 :</p> <pre><code>R1_TRS# enable\nR1_TRS(config)# interface gi0/0\nR1_TRS(config-if)# standby 10 ip 172.28.41.254\nR1_TRS(config-if)# standby 10 priority  105\nR1_TRS(config-if)# standby 10 preempt\nR1_TRS(config-if)# no shut\nR1_TRS(config-if)# exit\n</code></pre> <p>Ne pas oubli\u00e9 \"priority\" pour d\u00e9finir la priorit\u00e9 entre les deux routeurs. Cela signifie que ce routeur a une priorit\u00e9 de 105, et s'il n'y a pas d'autres routeurs dans le groupe HSRP avec une priorit\u00e9 plus \u00e9lev\u00e9e, il deviendra le routeur actif pour ce groupe. J'active la priorit\u00e9 sur R1_TRS il est cabl\u00e9 \u00e0 la fibre. </p> <p>Routeur 2 :</p> <pre><code>R2_TRS# enable\nR2_TRS(config)# interface gi0/0\nR2_TRS(config-if)# standby 10 ip 172.28.41.254\nR2_TRS(config-if)# standby 10 preempt\nR2_TRS(config-if)# no shut\nR2_TRS(config-if)# exit\n</code></pre> <p>Il est pr\u00e9f\u00e9rable de prioriser le routeur connect\u00e9 \u00e0 la fibre plut\u00f4t que celui li\u00e9 \u00e0 l'ADSL dans une configuration de haute disponibilit\u00e9 en raison de la fibre offrant de meilleures performances, un d\u00e9bit plus \u00e9lev\u00e9, une qualit\u00e9 de service sup\u00e9rieure, et une capacit\u00e9 \u00e0 g\u00e9rer une charge de trafic plus importante. Cela garantit que les applications essentielles fonctionnent bien lorsque tout va bien, tout en permettant une transition plus fluide vers la connexion ADSL en cas de panne de la fibre. Le choix d\u00e9pend de vos besoins sp\u00e9cifiques et de votre configuration r\u00e9seau.</p>"},{"location":"hsrp/#desactivation-du-protocole-hsrp-et-mise-en-place-du-protocole-glpb","title":"D\u00e9sactivation du protocole HSRP et mise en place du protocole GLPB","text":"<p>Le passage de HSRP (Hot Standby Router Protocol) \u00e0 GLBP (Gateway Load Balancing Protocol) peut \u00eatre pr\u00e9f\u00e9rable pour am\u00e9liorer la r\u00e9partition \u00e9quilibr\u00e9e du trafic sur un r\u00e9seau. GLBP permet une meilleure utilisation des ressources, une r\u00e9partition de charge plus \u00e9quitable entre les routeurs actifs, et une gestion plus flexible de la redondance asym\u00e9trique. Cette transition peut simplifier la configuration et garantir une haute disponibilit\u00e9 tout en optimisant l'utilisation des \u00e9quipements r\u00e9seau.</p> <p>Il suffit de mettre le pr\u00e9fixe \"no\" devant les commandes pour les annuler.</p> <p>Exemple pour le routeur \"R1_TRS\" :</p> <pre><code>R1_TRS# enable\nR1_TRS(config)# interface gi0/0\nR1_TRS(config-if)# no standby 10 ip 172.28.41.254\nR1_TRS(config-if)# no standby 10 priority  105\nR1_TRS(config-if)# no standby 10 preempt\nR1_TRS(config-if)# no shut\nR1_TRS(config-if)# exit\n</code></pre>"},{"location":"hsrp/#mise-en-place-du-protocle-glpb","title":"Mise en place du protocle GLPB","text":"<p>Le principe de VIP (Virutal IP) est le m\u00eame pour les deux protocoles. </p> <p>Pour configurer GLBP sur deux routeurs distincts (R1_TRS et R2_TRS) sans attribuer de priorit\u00e9 et en activant la r\u00e9partition de charge, il faut suivre ces \u00e9tapes :</p> <p>Configurez GLBP sur une interface (par exemple, FastEthernet0/0) et attribuez-lui une adresse IP virtuelle.</p> <p>Routeur 1 :</p> <pre><code>R1_TRS# enable\nR1_TRS# configure terminal\nR1_TRS(config)# interface gi0/0\nR1_TRS(config-if)# glbp 1 ip 172.28.41.254\nR1_TRS(config-if)# glbp 1 load-balancing host-dependent\n</code></pre> <p>Cela configure GLBP sur l'interface GigabiteEthernet0/0 avec l'adresse IP virtuelle 172.28.41.254 pour le groupe GLBP num\u00e9ro 1 et active la r\u00e9partition de charge en utilisant l'option \"load-balancing\" qui permet une r\u00e9partition des charges entre les 2 routeurs.</p> <p>Il faut r\u00e9p\u00e9ter les m\u00eames \u00e9tapes sur le routeur R2_TRS, en utilisant la m\u00eame configuration :</p> <p>Routeur 2 :</p> <pre><code>R2_TRS# enable\nR2_TRS# configure terminal\nR2_TRS(config)# interface gi0/0\nR2_TRS(config-if)# glbp 1 ip 172.28.41.254\nR2_TRS(config-if)# glbp 1 load-balancing host-dependent\n</code></pre> <p>Apr\u00e8s avoir effectu\u00e9 ces configurations sur les deux routeurs, ils fonctionneront ensemble pour fournir la haute disponibilit\u00e9 et la r\u00e9partition de charge. Les deux routeurs partageront la charge du trafic entrant vers l'adresse IP virtuelle (172.28.41.254) du groupe GLBP 1 sans attribuer de priorit\u00e9, car GLBP g\u00e8re automatiquement la r\u00e9partition de charge entre les routeurs actifs.</p>"},{"location":"hsrp/#explication-des-commandes-glpb","title":"Explication des commandes GLPB","text":"<p>R1_TRS(config)# interface gi0/0: Cette commande vous place dans le mode de configuration de l'interface GigabitEthernet0/0 (gi0/0) du routeur R1_TRS. Cela signifie que toutes les commandes suivantes que vous entrez affecteront cette interface sp\u00e9cifique.</p> <p>R1_TRS(config-if)# glbp 1 ip 172.28.41.254: Cette commande configure GLBP sur l'interface gi0/0 du routeur R1_TRS pour le groupe GLBP num\u00e9ro 1. Elle attribue l'adresse IP virtuelle 172.28.41.254 \u00e0 ce groupe GLBP. Toutes les communications destin\u00e9es \u00e0 cette adresse IP seront g\u00e9r\u00e9es par le routeur actif dans le groupe GLBP.</p> <p>R1_TRS(config-if)# glbp 1 load-balancing round-robin: Cette commande active la r\u00e9partition de charge en mode \"round-robin\" pour le groupe GLBP num\u00e9ro 1 sur l'interface gi0/0. Le mode \"round-robin\" r\u00e9partit \u00e9quitablement le trafic entrant entre les routeurs actifs dans le groupe GLBP. Chaque routeur actif traite des demandes de mani\u00e8re s\u00e9quentielle, contribuant ainsi \u00e0 \u00e9quilibrer la charge entre les routeurs du groupe.</p>"},{"location":"infra/","title":"Infrastructure de Tours","text":""},{"location":"infra/#infrastructure","title":"Infrastructure","text":"Nombre d'utilisateurs 179 Nombres de stations de travail 95 Fixes 90 Portables 5 Nombre de serveus 10"},{"location":"infra/#plan-dadressage","title":"Plan d'adressage","text":"Nom Adresse r\u00e9seau Masque (CIDR, Binaire) Broadcast Chateauroux 172.28.0.0 /19 255.255.224.0 172.28.31.255 Tours 172.28.32.0 /19 255.255.224.0 172.28.63.255 Chartres 172.28.64.0 /19 255.255.224.0 172.28.95.255 Orl\u00e9ans 172.28.96.0 /19 255.255.224.0 172.28.127.255"},{"location":"infra/#vlan-tours","title":"VLAN Tours","text":"VLAN Adress r\u00e9seau + CIDR Plage d'adresse Broadcast Service 220 172.28.32.0 /24 172.28.32.1 - 172.28.32.254 172.28.32.255 Management 221 192.168.37.0 /24 192.168.37.1 - 192.168.37.254 192.168.37.255 DMZ PUB 222 172.28.37.0 /24 172.28.37.1 - 172.28.37.254 172.28.37.255 Serveur 223 192.168.137.0 /24 192.168.137.1 - 192.168.137.254 192.168.137.255 DMZ PRV 224 172.28.36.0 /24 172.28.36.1 - 172.28.36.254 172.28.36.255 ... 225 172.28.34.0 /24 172.28.34.1 - 172.28.34.254 172.28.34.255 ... 226 172.28.38.0 /24 172.28.38.1 - 172.28.38.254 172.28.38.255 Conception 227 172.28.39.0 /24 172.28.39.1 - 172.28.39.254 172.28.39.255 Production 228 172.28.40.0 /24 172.28.40.1 - 172.28.40.254 172.28.40.255 Transport-firewall 229 172.28.41.0 /24 172.28.41.1 - 172.28.41.254 172.28.41.255 Transport-routeur Port Vlan gi0/1 - gi0/2 220 gi0/6 - gi0/8 221 gi0/3 - gi0/4 222 gi0/13 226 gi0/14 227 gi0/18 - gi0/20 228 gi0/15 - gi0/17 - gi0/19 - gi0/21 229"},{"location":"infra/#plan-dadressage-de-tours","title":"Plan d'adressage de Tours","text":""},{"location":"infra/#plan-dadressage-vlan-management","title":"Plan d'adressage Vlan Management","text":""},{"location":"infra/#cablage-infrastructure","title":"C\u00e2blage Infrastructure","text":""},{"location":"infra/#port-attribuer-au-switch","title":"Port attribuer au switch","text":""},{"location":"infra/#details-des-equipements-serveurs","title":"D\u00e9tails des \u00e9quipements serveurs","text":"Nom Fonction OS TRS_DC_01 Contr\u00f4leur principal de domaine Windows server 2008 R2 Serveur primaire DNS Domaine : tour.local Serveur DHCP Serveur de fichiers TRS_DC_02 Controleur secondaire de domaine Windows server 2008 R2 Serveur secondaire DNS Serveur de fichiers r\u00e9pliqu\u00e9"},{"location":"inter_vlan/","title":"Inter VLAN","text":""},{"location":"inter_vlan/#presentation","title":"Pr\u00e9sentation","text":"<p>La mise en place d'inter-VLAN avec le protocole 802.1Q offre de nombreux avantages pour la gestion et l'optimisation des r\u00e9seaux d'entreprise. Cela permet de segmenter le trafic, renfor\u00e7ant ainsi la s\u00e9curit\u00e9, optimisant les performances et isolant les domaines de diffusion. De plus, les VLANs permettent de s\u00e9parer logiquement les fonctions, d'optimiser la bande passante, d'assurer l'\u00e9volutivit\u00e9 du r\u00e9seau et de simplifier la gestion. En r\u00e9sum\u00e9, cette configuration est essentielle pour garantir une connectivit\u00e9 efficace et s\u00e9curis\u00e9e au sein d'un r\u00e9seau d'entreprise.</p> <p>Ici l'utilisation de l'inter-VLAN avec le protocole 802.1Q permet aux administrateurs du VLAN de management (VLAN 220) d'acc\u00e9der et de g\u00e9rer les routeurs sur le VLAN transport routeur (VLAN 229) de mani\u00e8re s\u00e9curis\u00e9e. Cela garantit une connectivit\u00e9 efficace tout en maintenant la s\u00e9paration logique et la s\u00e9curit\u00e9 entre ces deux VLANs.</p>"},{"location":"inter_vlan/#mise-en-place-de-linter-vlan","title":"Mise en place de l'inter VLAN","text":"<ul> <li>\u00c9tape 1 (sur commutateur) :</li> </ul> <p>Configuration des ports (0/11 et 0/12) en mode Trunk :</p> <pre><code>sw_Tours# conf t\nsw_Tours(config)# int gi0/11\nsw_Tours(config-if)# switchport encapsulation dot1q\nsw_Tours(config-if)# switchport mode trunk\nsw_Tours(config-if)# no shut\nsw_Tours(config-if)# exi\nsw_Tours(config)# vtp mode transparent\nsw_Tours(config)# exi\n\n</code></pre> <pre><code>sw_Tours# conf t\nsw_Tours(config)# int gi0/12\nsw_Tours(config-if)# switchport encapsulation dot1q\nsw_Tours(config-if)# switchport mode trunk\nsw_Tours(config-if)# no shut\nsw_Tours(config-if)# exi\nsw_Tours(config)# vtp mode transparent\nsw_Tours(config)# exi\n</code></pre> <p>Le \"mode trunk\" est utilis\u00e9 sur un commutateur pour permettre le transport de plusieurs VLANs sur un port.</p> <p>La commande \"encapsulation dot1Q\" est utilis\u00e9e sur une sous-interface de routeur pour prendre en charge les trames VLAN 802.1Q et les traiter en cons\u00e9quence.</p> <p>Le mode transparent sert \u00e0 \u00e9viter toute modification non autoris\u00e9e des VLANs</p> <ul> <li>\u00c9tape 2 (sur R1_TRS) :</li> </ul> <p>Configuration des sous-interfaces VLAN sans oublier de remettre en place le procotole GLBP ainsi que le NAT :</p> <pre><code>R1_TRS# conf t\nR1_TRS(config)# interface GigabitEthernet0/0.229\nR1_TRS(config-if)# encapsulation dot1Q 229\nR1_TRS(config-if)# ip address 172.28.41.253 255.255.255.0\nR1_TRS(config-if)# ip nat inside\nR1_TRS(config-if)# glbp 1 load-balancing host-dependent\nR1_TRS(config-if)# glbp 1 ip 172.28.41.254\nR1_TRS(config-if)# no shut\n</code></pre> <pre><code>R1_TRS# conf t\nR1_TRS(config)# interface GigabitEthernet0/0.220\nR1_TRS(config-if)# encapsulation dot1Q 220\nR1_TRS(config-if)# ip address 172.28.32.100 255.255.255.0\n</code></pre> <ul> <li>\u00c9tape 3 (sur R2_TRS) :</li> </ul> <pre><code>R2_TRS# conf t\nR2_TRS(config)# interface GigabitEthernet0/0.229\nR2_TRS(config-if)# encapsulation dot1Q 229\nR2_TRS(config-if)# ip address 172.28.41.252 255.255.255.0\nR2_TRS(config-if)# ip nat inside\nR2_TRS(config-if)# glbp 1 load-balancing host-dependent\nR2_TRS(config-if)# glbp 1 ip 172.28.41.254\nR2_TRS(config-if)# no shut\n</code></pre> <pre><code>R2_TRS# conf t\nR2_TRS(config)# interface GigabitEthernet0/0.220\nR2_TRS(config-if)# encapsulation dot1Q 220\nR2_TRS(config-if)# ip address 172.28.32.200 255.255.255.0\n</code></pre> <p>Apr\u00e8s avoir mis en place la configuration d'inter-VLAN avec le protocole 802.1Q, je peux maintenant me connecter depuis mon VLAN de gestion (VLAN 220) et administrer mes routeurs (VLAN 229).</p>"},{"location":"load_balancing/","title":"Configuration du Load Balancing","text":""},{"location":"load_balancing/#presentation","title":"Pr\u00e9sentation","text":"<p>Le Load Balancing (\u00e9quilibrage de charge) est une technique utilis\u00e9e pour distribuer la charge de travail entre plusieurs serveurs ou ressources r\u00e9seau afin d'optimiser les performances, d'assurer la disponibilit\u00e9 continue et de pr\u00e9venir la surcharge d'un seul point.</p>"},{"location":"load_balancing/#installation","title":"Installation","text":"<ul> <li>\u00c9tape 1 : Installation de Nginx sur les serveurs Proxy (Reverse Proxy)</li> </ul> <pre><code>sudo apt update\nsudo apt install nginx\n</code></pre> <ul> <li>\u00c9tape 2 : Configuration de Nginx pour le Load Balancing</li> </ul> <p>Modifier le fichier nginx.conf sur vos serveurs proxy pour inclure la configuration du load balancing.</p> <pre><code># Emplacement : /etc/nginx/nginx.conf\n\nhttp {\n    upstream backend {\n        server 192.168.37.50;\n        server 192.168.37.51;\n    }\n\n    server {\n        listen 80;\n        server_name www.tours.sportludique.fr;\n\n        location / {\n            proxy_pass http://backend;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n        }\n    }\n\n    # ... Autres configurations ...\n}\n</code></pre> <ul> <li>\u00c9tape 3 : Red\u00e9marrage de Nginx</li> </ul> <pre><code>sudo systemctl restart nginx\n</code></pre> <ul> <li>\u00c9tape 4 : Diff\u00e9rencier les pages WEB</li> </ul> <p>Acc\u00e9dez \u00e0 vos serveurs WEB et faire une l\u00e9ger changement sur le HTML pour diff\u00e9rencier les deux serveurs WEB, comme changer la couleur des titres (rouge/bleu).</p> <ul> <li>\u00c9tape 5 : Test</li> </ul> <p>Pour faire le test il suffit d'acc\u00e9der \u00e0 votre page WEB et de la rafraichir (F5), si les titres de vos pages WEB changent de couleur alors tout fonctionne parfaitement.</p>"},{"location":"nutanix/","title":"Nutanix","text":""},{"location":"nutanix/#presentation","title":"Pr\u00e9sentation","text":"<p>Nutanix est une solution informatique r\u00e9volutionnaire qui simplifie consid\u00e9rablement la gestion de l'infrastructure informatique et des r\u00e9seaux pour les entreprises. Elle est particuli\u00e8rement pertinente pour les administrateurs r\u00e9seau qui cherchent \u00e0 optimiser la cr\u00e9ation et la gestion de machines virtuelles (VM) tout en assurant une administration r\u00e9seau efficace.</p>"},{"location":"nutanix/#initialisation-a-nutanix","title":"Initialisation \u00e0 Nutanix","text":"<ul> <li>\u00c9tape 1 : Acc\u00e9der \u00e0 l'URL fournie par votre professeur </li> </ul> <p>(https://172.16.90.200:9440)</p> <ul> <li>\u00c9tape 2 : Authentification sur la plateforme Nutanix </li> </ul> <p>Login : \"nom\"@lan.sio.lyceefulbert.fr</p> <p>Mot de passe : \"Mdp de lan.sio.lyceefulbert.fr\"</p> <ul> <li>\u00c9tape 3 : Acc\u00e9der au tableau de bord Nutanix</li> </ul> <p></p> <ul> <li>\u00c9tape 4 : Cr\u00e9ation de votre machine virtuelle (VM)</li> </ul> <p></p>"},{"location":"nutanix/#creation-de-la-machine-virtuelle","title":"Cr\u00e9ation de la machine virtuelle","text":"<ul> <li>\u00c9tape 1 : Donner un nom \u00e0 la VM</li> </ul> <p>Donner un nom significatif \u00e0 la machine virtuelle, ici on utilise \"TRS_DC_01\" (Tours_Domaine Controller_Num\u00e9ro 1). Cela permettra de l'identifier facilement dans notre environnement virtuel.</p> <ul> <li>\u00c9tape 2 : Attribution de la m\u00e9moire RAM</li> </ul> <p>Augmenter la quantit\u00e9 de RAM de la VM \u00e0 6 Go. Par d\u00e9faut, il y a 4 Go de RAM, mais nous pouvons augmenter cette valeur pour r\u00e9pondre aux besoins de notre VM.</p> <ul> <li>\u00c9tape 3 : Ajouter l'ISO de Windows Server 2022</li> </ul> <p>Ajouter l'ISO de Windows Server 2022 \u00e0 la VM. Utilisez l'ISO nomm\u00e9 \"fr-fr_windows_server_2022_updated_aug_2023_x64_dvd_78639bda.iso\" fourni par le professeur. Cela permettra de d\u00e9marrer la VM \u00e0 partir de cet ISO pour l'installation de Windows Server 2022.</p> <ul> <li>\u00c9tape 4 : Ajouter l'ISO de Nutanix</li> </ul> <p>Ajouter \u00e9galement l'ISO de Nutanix \u00e0 la VM. Utilisez l'ISO nomm\u00e9 \"Nutanix-VirtIO-1.2.1.iso\" fourni par votre professeur. Cette \u00e9tape est importante pour la configuration de la VM avec les pilotes et les outils n\u00e9cessaires.</p> <ul> <li>\u00c9tape 5 : Ajouter un disque de 50 Go</li> </ul> <p>Ajouter un disque suppl\u00e9mentaire de 50 Go \u00e0 la VM. Ce disque servira \u00e0 stocker des fichiers, notamment les ISO que nous avons ajout\u00e9s pr\u00e9c\u00e9demment.</p> <ul> <li>\u00c9tape 6 : Attacher un sous-r\u00e9seau VLAN</li> </ul> <p>Associer un sous-r\u00e9seau VLAN \u00e0 la VM. On utilise le VLAN 222 qui a \u00e9t\u00e9 pr\u00e9c\u00e9demment configur\u00e9 pour le serveur. Cette \u00e9tape permet \u00e0 la VM d'\u00eatre connect\u00e9e au r\u00e9seau correct.</p> <ul> <li>\u00c9tape 7 : Activer \"Use this VM as an agent VM\"</li> </ul> <p>Cocher la case \"Use this VM as an agent VM\". Cela indique \u00e0 la VM de fonctionner en tant que VM agent, ce qui peut \u00eatre n\u00e9cessaire pour certaines fonctionnalit\u00e9s de gestion sp\u00e9cifiques \u00e0 Nutanix.</p> <ul> <li>\u00c9tape 8 : Cr\u00e9er la VM et suivre les \u00e9tapes d'installation de Windows</li> </ul> <p>Enfin, cr\u00e9er la VM. Une fois la VM cr\u00e9\u00e9e, d\u00e9marrez-la \u00e0 partir de l'ISO de Windows Server 2022 et suivez les \u00e9tapes d'installation de Windows, en veillant \u00e0 configurer les param\u00e8tres r\u00e9seau et autres param\u00e8tres selon vos besoins. Sans oublier de s\u00e9lectionner les hyperviseurs de Nutanix dans le dossier /Windows 2022/64x</p>"},{"location":"port_mirroring/","title":"Port mirroring","text":""},{"location":"port_mirroring/#presentation","title":"Pr\u00e9sentation","text":"<p>Le port mirroring est une fonctionnalit\u00e9 des commutateurs r\u00e9seau qui permet de copier le trafic d'un ou plusieurs ports sources vers un port de destination, g\u00e9n\u00e9ralement connect\u00e9 \u00e0 un outil d'analyse tel que Wireshark. Cette technique est largement utilis\u00e9e pour surveiller, d\u00e9panner, analyser et optimiser le trafic r\u00e9seau. En configurant le port mirroring, les administrateurs peuvent capturer des trames r\u00e9seau \u00e0 partir d'un firewall, par exemple, pour effectuer une analyse approfondie \u00e0 l'aide de Wireshark. Cela permet de d\u00e9tecter des anomalies, d'identifier des probl\u00e8mes de performances, de renforcer la s\u00e9curit\u00e9 et d'optimiser le r\u00e9seau, offrant ainsi une visibilit\u00e9 pr\u00e9cieuse sur le trafic r\u00e9seau en temps r\u00e9el.</p>"},{"location":"port_mirroring/#mise-en-place-du-port-mirroring","title":"Mise en place du port mirroring","text":"<ul> <li>\u00c9tape 1 : Attribuer le VLAN \"Transport-routeur\" (229) au port destination</li> </ul> <pre><code>sw_Tours(config)# interface GigabitEthernet0/23\nsw_Tours(config-if)# switchport access vlan 229\nsw_Tours(config-if)# switchport mode access\nsw_Tours(config-if)# exit\n</code></pre> <ul> <li>\u00c9tape 2 : Copier le trafic du port GigabitEthernet 0/21 (connect\u00e9 au firewall) dans les deux sens (\"both\") vers le port GigabitEthernet 0/23 </li> </ul> <pre><code>sw_Tours(config)# monitor session 1 source interface GigabitEthernet0/1 both\nsw_Tours(config)# monitor session 1 destination interface GigabitEthernet0/23\n</code></pre> <ul> <li>\u00c9tape 3 : Faire un test</li> </ul> <p>Brasser un poste (ici le poste M2_P3) au port GigabitEthernet 0/23 puis aller sur WireShark afin de faire une analyse de trame. </p>"},{"location":"routeur/","title":"Routeurs","text":""},{"location":"routeur/#presentation","title":"Pr\u00e9sentation","text":"<p>Un routeur est un dispositif essentiel dans les r\u00e9seaux informatiques, permettant de connecter et de diriger le trafic entre diff\u00e9rents r\u00e9seaux. Sa principale utilit\u00e9 r\u00e9side dans le routage des donn\u00e9es, la s\u00e9paration des r\u00e9seaux et la gestion des flux d'information au sein des infrastructures informatiques.</p>"},{"location":"routeur/#infrastructure-publique-simulee-dans-le-labo-du-lycee-fulbert","title":"Infrastructure Publique simul\u00e9e dans le labo du lyc\u00e9e Fulbert","text":""},{"location":"routeur/#mise-en-place-du-natpat","title":"Mise en place du NAT/PAT","text":"<ul> <li>\u00c9tape 1 : Acc\u00e9der au mode de configuration </li> </ul> <p>Je me connecte au routeur Cisco en utilisant l'\u00e9mulateur de terminal PuTTY car SSH a \u00e9t\u00e9 ativ\u00e9 en amont.</p> <ul> <li>\u00c9tape 2 : Activer le routing.</li> </ul> <pre><code>R1_TRS# enable\nR1_TRS(config)# ip routing\n</code></pre> <ul> <li>\u00c9tape 3 : Configurer le NAT/PAT</li> </ul> <p>Je configure le NAT/PAT en utilisant l'interface sp\u00e9cifique o\u00f9 le trafic entrant est re\u00e7u (GigabitEthernet0/0) et l'interface connect\u00e9e \u00e0 Internet (GigabitEthernet0/1) :</p> <pre><code>R1_TRS# configure terminal\nR1_TRS(config)# interface gi0/0\nR1_TRS(config-if)# 172.28.41.254 255.255.255.0\nR1_TRS(config-if)# ip nat inside\nR1_TRS(config-if)# no shutdown\nexit\n\nR1_TRS# configure terminal\nR1_TRS(config)# interface gi0/1\nR1_TRS(config-if)# 183.44.37.1 255.255.255.252\nR1_TRS(config-if)# ip nat outside\nR1_TRS(config-if)# no shutdown\nexit\n</code></pre> <ul> <li>\u00c9tape 4 : Cr\u00e9er une liste d'acc\u00e8s (ACL)</li> </ul> <p>Je cr\u00e9e une liste d'acc\u00e8s \u00e9tendue qui sp\u00e9cifie les adresses IP priv\u00e9es \u00e0 traduire en adresses IP publiques :</p> <pre><code>R1_TRS(config)# ACCESS-LIST 1 PERMIT 172.28.32.0 0.0.31.255\n</code></pre> <p>L'expression \"access-list 1 permit 172.28.32.0 0.0.31.255\" d\u00e9finit une liste d'acc\u00e8s (ACL) sur un routeur Cisco pour permettre ou autoriser le trafic provenant de l'adresse IP sp\u00e9cifi\u00e9e, 172.28.32.0, avec un masque de sous-r\u00e9seau de 0.0.31.255. Cette ACL est configur\u00e9e pour autoriser (permit) tout le trafic provenant de l'intervalle d'adresses 172.28.32.0 \u00e0 172.28.63.255.</p> <ul> <li>\u00c9tape 5 : Configurer le NAT/PAT</li> </ul> <p>Je configure le NAT/PAT en utilisant la liste d'acc\u00e8s (ACL) que j'ai cr\u00e9\u00e9e :</p> <pre><code>R1_TRS(config)# IP NAT INSIDE SOURCE LIST 1 INTERFACE GI0/1 OVERLOAD\n</code></pre> <p>Sp\u00e9cifier la route par d\u00e9faut.</p> <pre><code>R1_TRS(config)# IP ROUTE 0.0.0.0 0.0.0.0 183.44.37.2\n</code></pre> <ul> <li>\u00c9tape 6 : Appliquer la configuration</li> </ul> <pre><code>R1_TRS(config)# write memory\n</code></pre> <ul> <li>\u00c9tape 7 : Test</li> </ul> <p>Un test de ping vers l'adresse IP 8.8.8.8, qui est associ\u00e9e aux serveurs DNS de Google, sert \u00e0 v\u00e9rifier la connectivit\u00e9 r\u00e9seau entre votre appareil (g\u00e9n\u00e9ralement un ordinateur) et les serveurs de Google. Voici comment cela fonctionne et \u00e0 quoi cela sert :</p> <pre><code>R1_TRS#ping 8.8.8.8\nType escape sequence to abort.\nSending 5, 100-byte ICMP Echos to 8.8.8.8, timeout is 2 seconds:\n!!!!!\n</code></pre>"},{"location":"serveur_http/","title":"Cr\u00e9ation VM HTTP","text":"<p>Rajouter l'ACL sur les Routeurs pour que l'adresse r\u00e9seau de la DMZ puisse acc\u00e9der \u00e0 Internet. Ajouter la redirection de port sur les routeurs pour le port 80.</p>"},{"location":"serveur_http/#configuration","title":"Configuration","text":"<ul> <li>\u00c9tape 1 : Donner un nom \u00e0 la VM</li> </ul> <p>Donner un nom significatif \u00e0 la machine virtuelle, ici on utilise \"TRS_SRV_HTTP\" (Tours_Serveur_HTTP). Cela permettra de l'identifier facilement dans notre environnement virtuel.</p> <ul> <li>\u00c9tape 2 : Attribution de la m\u00e9moire RAM</li> </ul> <p>Diminuer la quantit\u00e9 de RAM de la VM \u00e0 2 Go. Par d\u00e9faut, il y a 4 Go de RAM, mais nous pouvons diminuer cette valeur pour r\u00e9pondre aux besoins de notre VM.</p> <ul> <li>\u00c9tape 3 : Ajouter l'ISO de Debian 12</li> </ul> <p>Ajouter l'ISO de Debian 12 \u00e0 la VM. Utilisez l'ISO nomm\u00e9 \"debian-12.1.0-amd64-netinst.iso\" fourni par le professeur. Cela permettra de d\u00e9marrer la VM \u00e0 partir de cet ISO.</p> <ul> <li>\u00c9tape 4 : Ajouter un disque de 25 Go</li> </ul> <p>Ajouter un disque de 25 Go \u00e0 la VM. Ce disque servira \u00e0 stocker des fichiers, notamment les ISO que nous avons ajout\u00e9s pr\u00e9c\u00e9demment.</p> <ul> <li>\u00c9tape 5 : Attacher un sous-r\u00e9seau VLAN</li> </ul> <p>Associer un sous-r\u00e9seau VLAN \u00e0 la VM. On utilise le VLAN 221 qui a \u00e9t\u00e9 pr\u00e9c\u00e9demment configur\u00e9e. Cette \u00e9tape permet \u00e0 la VM d'\u00eatre connect\u00e9e au r\u00e9seau correct.</p> <p>Une fois la VM lanc\u00e9e nous faisont l'installation </p> <p>Ajouter les utilisateurs dans le sudo user.</p> <pre><code>sudo usermod -aG sudo \"Nom d'utilisateur\" \nsudo systemctl reboot\n</code></pre>"},{"location":"trs_dm/","title":"Service DNS &amp; DHCP","text":""},{"location":"trs_dm/#installation-dns","title":"Installation DNS","text":"<ul> <li>\u00c9tape 1 : Installation du service DNS</li> </ul> <p>Je me connecte \u00e0 mon serveur Windows.</p> <p>J'ouvre le \"Gestionnaire de serveur\" depuis le menu \"G\u00e9rer\" dans la barre des t\u00e2ches ou en tapant \"ServerManager\" dans la ligne de commande.</p> <p>Dans le Gestionnaire de serveur, je clique sur \"G\u00e9rer\" dans le coin sup\u00e9rieur droit, puis je s\u00e9lectionne \"Ajouter des r\u00f4les et des fonctionnalit\u00e9s\".</p> <p>Je suis l'assistant d'ajout de r\u00f4les et de fonctionnalit\u00e9s et s\u00e9lectionne le r\u00f4le \"Serveur DNS\".</p> <p>Je termine l'installation en suivant les \u00e9tapes de l'assistant. Une fois l'installation termin\u00e9e, je ferme l'assistant.</p> <ul> <li>\u00c9tape 2 : Configuration du service DNS pour \"local.tours.sportludique.fr\"</li> </ul> <p>Apr\u00e8s l'installation, je vais dans le \"Gestionnaire de serveur\" et je d\u00e9veloppe \"Outils\" &gt; \"Services de r\u00f4les\" &gt; \"Serveur DNS\".</p> <p>Sous \"Serveur DNS\", je clique avec le bouton droit sur le serveur DNS nouvellement install\u00e9 et je s\u00e9lectionne \"Nouvelle zone de recherche directe\" (Forward Lookup Zone).</p> <p>Dans l'assistant de cr\u00e9ation de zone, je choisis de cr\u00e9er une zone primaire et j'entre \"local.tours.sportludique.fr\" comme nom de zone.</p> <ul> <li>\u00c9tape 3 : V\u00e9rification et test du service DNS</li> </ul> <p>Pour tester le service DNS, je peux utiliser la commande \"nslookup\" sur le serveur ou d'autres machines de mon r\u00e9seau pour r\u00e9soudre des noms de domaine en adresses IP.</p> <p>Je peux \u00e9galement configurer la machine virtuelle Windows 10 client (mentionn\u00e9e dans la pr\u00e9c\u00e9dente r\u00e9ponse) pour utiliser le serveur DNS nouvellement configur\u00e9 en tant que serveur DNS primaire.</p> <p>Ensuite, je teste la r\u00e9solution DNS en utilisant des noms de domaine de \"local.tours.sportludique.fr\" pour m'assurer que les enregistrements DNS sont corrects et que les r\u00e9solutions fonctionnent comme pr\u00e9vu.</p>"},{"location":"trs_dm/#installation-dhcp","title":"Installation DHCP","text":"<ul> <li>\u00c9tape 1 : Installation du serveur DHCP</li> </ul> <p>Je me connecte \u00e0 mon serveur Windows (dans mon cas, Windows Server 2016 ou version ult\u00e9rieure).</p> <p>J'ouvre le \"Gestionnaire de serveur\" depuis le menu \"G\u00e9rer\" dans la barre des t\u00e2ches ou en tapant \"ServerManager\" dans la ligne de commande.</p> <p>Dans le Gestionnaire de serveur, je clique sur \"G\u00e9rer\" dans le coin sup\u00e9rieur droit, puis je s\u00e9lectionne \"Ajouter des r\u00f4les et des fonctionnalit\u00e9s\".</p> <p>Je suis l'assistant d'ajout de r\u00f4les et de fonctionnalit\u00e9s et s\u00e9lectionne le r\u00f4le \"Serveur DHCP\".</p> <p>Je termine l'installation en suivant les \u00e9tapes de l'assistant. Une fois l'installation termin\u00e9e, je ferme l'assistant.</p> <ul> <li>\u00c9tape 2 : Configuration des \u00e9tendues DHCP</li> </ul> <p>Apr\u00e8s l'installation, je vais dans le \"Gestionnaire de serveur\" et je d\u00e9veloppe \"Outils\" &gt; \"Services de r\u00f4les\" &gt; \"Serveur DHCP\".</p> <p>Sous \"Serveur DHCP\", je clique avec le bouton droit sur le serveur DHCP nouvellement install\u00e9 et je s\u00e9lectionne \"Nouvelle \u00e9tendue\".</p> <p>Je configure la premi\u00e8re \u00e9tendue \"Conception\" en sp\u00e9cifiant une plage d'adresses IP de 172.28.38.10 \u00e0 172.28.38.250, le masque de sous-r\u00e9seau appropri\u00e9 (g\u00e9n\u00e9ralement 255.255.255.0), la passerelle par d\u00e9faut et les serveurs DNS.</p> <p>Je r\u00e9p\u00e8te le processus pour cr\u00e9er la deuxi\u00e8me \u00e9tendue \"Production\" en sp\u00e9cifiant la plage d'adresses IP de 172.28.39.10 \u00e0 172.28.39.250, ainsi que les autres param\u00e8tres requis.</p> <p>Une fois les \u00e9tendues configur\u00e9es, je les active pour permettre au serveur DHCP de distribuer des adresses IP.</p> <ul> <li>\u00c9tape 3 : Configuration de la machine virtuelle Windows 10 client</li> </ul> <p>J'installe Oracle VM VirtualBox sur ma machine si ce n'est pas d\u00e9j\u00e0 fait, puis je le lance.</p> <p>Je cr\u00e9e une nouvelle machine virtuelle en sp\u00e9cifiant Windows 10 comme syst\u00e8me d'exploitation invit\u00e9 et en suivant les \u00e9tapes de configuration (m\u00e9moire, disque dur virtuel, etc.).</p> <p>Dans les param\u00e8tres de la machine virtuelle, je vais dans \"R\u00e9seau\" et je configure l'adaptateur r\u00e9seau en mode \"Bridged\" (pont) pour qu'il puisse se connecter au r\u00e9seau physique.</p> <p>Je d\u00e9marre la machine virtuelle Windows 10 et je m'assure qu'elle obtient une adresse IP automatiquement du serveur DHCP que j'ai configur\u00e9 pr\u00e9c\u00e9demment.</p> <p>Je v\u00e9rifie que la machine virtuelle peut acc\u00e9der au r\u00e9seau et \u00e0 Internet.</p> <ul> <li>\u00c9tape 4 : Test du serveur DHCP et du domaine</li> </ul> <p>Je peux maintenant tester le serveur DHCP en v\u00e9rifiant si la machine virtuelle Windows 10 re\u00e7oit une adresse IP de l'une des \u00e9tendues que j'ai configur\u00e9es (Conception ou Production).</p> <p>Si la machine virtuelle re\u00e7oit avec succ\u00e8s une adresse IP, je peux \u00e9galement tester la connectivit\u00e9 au serveur DHCP en ex\u00e9cutant des commandes telles que \"ipconfig /renew\" pour renouveler l'adresse IP.</p> <p>Ensuite, je peux configurer la machine virtuelle Windows 10 pour rejoindre le domaine Active Directory (si d\u00e9j\u00e0 configur\u00e9) en utilisant les param\u00e8tres appropri\u00e9s.</p> <p>Une fois connect\u00e9e au domaine, je peux tester l'authentification en me connectant en tant qu'utilisateur du domaine et en acc\u00e9dant aux ressources partag\u00e9es du r\u00e9seau.</p>"},{"location":"vlan/","title":"Documentation VLAN","text":""},{"location":"vlan/#vlans","title":"VLANS","text":"VLAN Adresses r\u00e9seau + CIDR Plage d'adresse Broadcast Service 220 172.28.32.0 /24 172.28.32.1 - 172.28.32.254 172.28.32.255 Management 221 192.168.37.0 /24 192.168.37.1 - 192.168.37.254 192.168.37.255 DMZ 222 172.28.34.0 /24 172.28.34.1 - 172.28.34.254 172.28.34.255 srv/ad/dhcp 223 172.28.35.0 /24 172.28.35.1 - 172.28.35.254 172.28.35.255 ... 224 172.28.36.0 /24 172.28.36.1 - 172.28.36.254 172.28.36.255 ... 225 172.28.37.0 /24 172.28.37.1 - 172.28.37.254 172.28.37.255 ... 226 172.28.38.0 /24 172.28.38.1 - 172.28.38.254 172.28.38.255 Conception 227 172.28.39.0 /24 172.28.39.1 - 172.28.39.254 172.28.39.255 Production 228 172.28.40.0 /24 172.28.40.1 - 172.28.40.254 172.28.40.255 Transport - Firewall 229 172.28.41.0 /24 172.28.41.1 - 172.28.41.254 172.28.41.255 Transport - Router Port Vlan gi0/1 - gi0/2 220 ... 221 gi0/3 222 gi0/13 226 gi0/14 227 gi0/18 - gi0/20 228 gi0/17 - gi0/19 - gi0/21 229"},{"location":"wordpress/","title":"Wordpress","text":""},{"location":"wordpress/#installation","title":"Installation","text":"<ul> <li>Etape 1 : T\u00e9lechargement du paquet Wordpress </li> </ul> <p>On t\u00e9l\u00e9charge le paquet wordpress grace a la commande</p> <pre><code>cd /tmp \nwget https://wordpress.org/latest.zip\n</code></pre> <ul> <li>Etape 2 : Cr\u00e9ation d'une basse de donn\u00e9e Mariadb</li> </ul> <p>On creer une VM Debian 11 avec dessus Mariadb qui va servir de base de donn\u00e9e pour le wordpress</p> <pre><code>mysql -u root -p\n</code></pre> <p>On cr\u00e9er la base de donn\u00e9e 'blog'</p> <pre><code>CREATE DATABASE blog;\n</code></pre> <p>On cr\u00e9er un utilisateur avec les droits sur la base de donn\u00e9e</p> <pre><code>CREATE USER 'Trswp'@'%' IDENTIFIED BY 'Votre-Super-Mot-De-Passe';\n</code></pre> <p>% = donne l'acc\u00e8s a tous les hotes est donc moin s\u00e9curiser, on devrais mettre l'adresse ip de notre serveur HTTP '192.168.37.50'</p> <p>On donne a l'utilisateur tous les droits </p> <pre><code>GRANT ALL PRIVILEGES ON blog.* TO 'Trswp'@'%';\n</code></pre> <p>on actualise les droits avec la commande</p> <pre><code>FLUSH PRIVILEGES;\n</code></pre> <p>On doit chang\u00e9 le Bind Address qui permet de li\u00e9 une adresse ip </p> <pre><code>sudo nano etc/mysql/mariadb.conf.d/50-server.cnf\n\nbind-address        = 0.0.0.0 (autorise toutes les connexions)\n                    = 192.168.37.50 (autorise la connexions avec l'h\u00f4te)\n</code></pre> <ul> <li>Etape 3 : D\u00e9compressage de l'archive wordpress</li> </ul> <p>on cr\u00e9er le fichier wordpress dans lequelle on va d\u00e9compresser l'archive</p> <pre><code>sudo rm /var/www/html/wordpress\n</code></pre> <p>On installe l'extension Zip</p> <pre><code>sudo apt-get install zip\n</code></pre> <p>Ensuite on d\u00e9compresse </p> <pre><code>sudo unzip latest.zip -d /var/www/wordpress\n</code></pre> <p>On ce d\u00e9place dans le dossier </p> <pre><code>cd /var/www/wordpress\n</code></pre> <p>On d\u00e9place tous le contenu du dossier wordpress a la racine du site</p> <pre><code>sudo mv wordpress/* /var/www/wordpress/wordpress\n</code></pre> <p>Ensuite on donne les droits a l'utilisateur de notre serveur Apache</p> <pre><code>sudo chown -R trs-admin:www-data /var/www/wordpress/wordpress\n</code></pre> <ul> <li>Etape 4 : Installation de Wordpress</li> </ul> <p>On se connecte a l'interface web avec l'adresse 'http://IP-SERVEUR'</p> <p>Si vous n'arriver pas a acc\u00e9des a la page d'installation vous devez vous rendre sur votre serveur HTTP et ce rendre dans le fichier 'php.ini' et retirer le ; devant la ligne 'extension=mysqli'</p> <p></p> <p>On ajoute les informations </p> <p>Nom de la base de donn\u00e9es : dans cet exemple, ce sera \"blog\" Identifiant : le nom de l'utilisateur qui a les droits sur la base de donn\u00e9es, en l'occurrence \"Trswp\" Mot de passe : le mot de passe de cet utilisateur Adresse de la base de donn\u00e9es : si le serveur Web et la base de donn\u00e9es ne sont pas sur le m\u00eame serveur, indiquez l'adresse IP du serveur distant '192.168.137.50'</p> <p>On envoie les informations pour que wordpress essaie de se connecter a la base de donn\u00e9e. Si jamais Wordpress n'y arriver pas, vous devez ajouter un Enregistrement CNAME sur votre serveur DNS qui est dans le Vlan Serveur.</p> <p>Nom de l'alias : blog Nom de domaine : blog.tours.sportludique.fr Nom de domaine complet : www.tours.sportludique.fr.</p> <p>Et On suit l'installation apr\u00e8s \u00e7a.</p>"},{"location":"zabbix/","title":"Zabbix","text":""},{"location":"zabbix/#installation-de-zabbix-64-sous-debian-12","title":"Installation de Zabbix 6.4 sous Debian 12","text":"<p>Aller sur le site officiel de zabbix : zabbix.com/fr/download</p>"},{"location":"zabbix/#configuration-de-lenvironnement-zabbix","title":"Configuration de l'Environnement Zabbix","text":"<p>Version de Zabbix : 6.4 Distribution OS : Debian Version du syst\u00e8me d'exploitation : 12 Composants Zabbix : Server, Frontend, Agent Base de donn\u00e9es : MySQL Serveur WEB : Apache</p>"},{"location":"zabbix/#etape-1-installer-le-repertoire-de-zabbix","title":"Etape 1 : Installer le r\u00e9pertoire de Zabbix :","text":"<p>--&gt; wget https://repo.zabbix.com/zabbix/6.4/debian/pool/main/z/zabbix-release/zabbix-release_6.4-1+debian12_all.deb --&gt; sudo dpkg -i zabbix-release_6.4-1+debian12_all.deb --&gt; sudo apt update</p>"},{"location":"zabbix/#etape-2-installation-des-composants-zabbix-serveur-frontend-configuration-apache-scripts-sql-agent","title":"Etape 2 : Installation des Composants Zabbix : Serveur, Frontend, Configuration Apache, Scripts SQL, Agent","text":"<p>Installation de la base de donn\u00e9es MySQL, de l'interface Web, du Serveur Web Apache pour l'interface Web, des scripts SQL pour cr\u00e9er la structure initiale de la base de donn\u00e9es et de l'Agent Zabbix : </p> <p>--&gt; sudo apt install zabbix-server-mysql zabbix-frontend-php zabbix-apache-conf zabbix-sql-scripts zabbix-agent</p>"},{"location":"zabbix/#creer-la-database-via-le-serveur-zabbix","title":"Creer la database via le serveur Zabbix","text":"<p>--&gt; sudo mysql -uroot -p En mot de passe : password</p> <p>Une fois dans mysql entr\u00e9 qui s'affichera en MariaDB [(none)]&gt; :</p> <p>--&gt; CREATE DATABASE zabbix character set utf8mb4 collate utf8mb4_bin; --&gt; CREATE USER zabbix@localhost IDENTIFIED BY 'password'; --&gt; GRANT ALL PRIVILEGES ON zabbix.* TO zabbix@localhost; --&gt; set global log_bin_trust_function_creators = 1; --&gt; exit;</p>"},{"location":"zabbix/#importation-du-schema-de-base-de-donnees-zabbix-dans-mysql","title":"Importation du Sch\u00e9ma de Base de Donn\u00e9es Zabbix dans MySQL","text":"<p>--&gt; sudo zcat /usr/share/zabbix-sql-scripts/mysql/server.sql.gz | mysql --default-character-set=utf8mb4 -uzabbix -p zabbix</p> <p>Desactiver log_bin_trust_function_creators</p> <p>--&gt; sudo mysql -uroot -p</p> <p>mariadb &gt; set global log_bin_trust_function_creators = 0;</p>"},{"location":"zabbix/#editer-le-fichier-etczabbixzabbix_serverconf","title":"Editer le fichier /etc/zabbix/zabbix_server.conf","text":"<p>--&gt; sudo nano /etc/zabbix/zabbix_server.conf</p> <p>Rechercher DBPassword=, retirer le commentaire et mettre : DBPassword=password</p>"},{"location":"zabbix/#redemarrer-le-zabbix-server-agent-et-apache-et-lactiver","title":"Red\u00e9marrer le Zabbix server, agent et apache et l'activer :","text":"<p>--&gt; sudo systemctl restart zabbix-server zabbix-agent apache2 --&gt; sudo systemctl enable zabbix-server zabbix-agent apache2</p>"},{"location":"zabbix/#acceder-a-linterface-zabbix","title":"Acc\u00e9der \u00e0 l'interface Zabbix :","text":"<p>--&gt; 172.28.37.30/zabbix</p> <p>Suivre les instructions.</p> <p>Rentrer par d\u00e9faut pour avoir acc\u00e8s \u00e0 l'interface de Zabbix :</p> <p>Utilisateur : Admin Mot de passe : zabbix</p>"}]}